# Tach module boundary configuration
# Goal: Protect infrastructure from accidental LLM edits while allowing
# rapid research iteration on models/experiments

exclude = [
    "**/__pycache__",
    "**/*egg-info",
    "**/docs",
    "**/tests",
    "**/venv",
    "**/.venv",
]

source_roots = ["src"]

# ============================================================
# INFRASTRUCTURE MODULES (protected, explicit dependencies)
# ============================================================

[[modules]]
path = "tmgg.experiment_utils.cloud"
depends_on = [
    "tmgg.experiment_utils",  # LocalRunner uses run_experiment
]
# Cloud execution layer - uses run_experiment from parent

[[modules]]
path = "tmgg.experiment_utils.data"
depends_on = []
# Data loading - no dependencies on other tmgg modules

[[modules]]
path = "tmgg.modal"
depends_on = [
    "tmgg.experiment_utils.cloud",  # Uses CloudRunner interface
    "tmgg.experiment_utils",        # Uses run_experiment
]
# Modal platform integration - depends on cloud abstraction and run_experiment

# ============================================================
# SHARED UTILITIES (semi-protected)
# ============================================================

[[modules]]
path = "tmgg.experiment_utils"
depends_on = [
    "tmgg.experiment_utils.cloud",
    "tmgg.experiment_utils.data",
]
# Base utilities can use cloud and data submodules

# ============================================================
# RESEARCH MODULES (unchecked for rapid iteration)
# ============================================================

[[modules]]
path = "tmgg.models"
depends_on = []
unchecked = true
# Model architectures - change frequently, no boundary enforcement

[[modules]]
path = "tmgg.experiments"
depends_on = []
unchecked = true
# Experiment runners - change frequently, no boundary enforcement
