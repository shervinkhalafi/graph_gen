
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Graph denoising research framework built with Hydra and PyTorch Lightning">
      
      
        <meta name="author" content="Igor Krawczuk">
      
      
      
        <link rel="prev" href="../data/">
      
      
        <link rel="next" href="../cloud/">
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="zensical-0.0.11">
    
    
      
        <title>Models - TMGG Documentation</title>
      
    
    
      
        
      
      <link rel="stylesheet" href="../assets/stylesheets/modern/main.bd6182e7.min.css">
      
      
  
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
  
  <style>:root{}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,500,500i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Inter";--md-code-font:"JetBrains Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,t)=>(e<<5)-e+t.charCodeAt(0)),0),__md_get=(e,t=localStorage,a=__md_scope)=>JSON.parse(t.getItem(a.pathname+"."+e)),__md_set=(e,t,a=localStorage,_=__md_scope)=>{try{a.setItem(_.pathname+"."+e,JSON.stringify(t))}catch(e){}},document.documentElement.setAttribute("data-platform",navigator.platform)</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#models" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="TMGG Documentation" class="md-header__button md-logo" aria-label="TMGG Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="lucide lucide-book-open" viewBox="0 0 24 24"><path d="M12 7v14M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="lucide lucide-menu" viewBox="0 0 24 24"><path d="M4 5h16M4 12h16M4 19h16"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            TMGG Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Models
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="lucide lucide-search" viewBox="0 0 24 24"><path d="m21 21-4.34-4.34"/><circle cx="11" cy="11" r="8"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog" aria-label="Search">
  <button type="button" class="md-search__button">
    Search
  </button>
</div>
      
    
    <div class="md-header__source">
      
    </div>
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="TMGG Documentation" class="md-nav__button md-logo" aria-label="TMGG Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="lucide lucide-book-open" viewBox="0 0 24 24"><path d="M12 7v14M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z"/></svg>

    </a>
    TMGG Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../get-started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Get started
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Guides
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Guides
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../experiments/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Experiments
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Models
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Models
  

    
  </span>
  
  

      </a>
      
        


<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#model-hierarchy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Model Hierarchy
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#attention-models" class="md-nav__link">
    <span class="md-ellipsis">
      
        Attention Models
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attention Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#multilayerattention" class="md-nav__link">
    <span class="md-ellipsis">
      
        MultiLayerAttention
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gnn-models" class="md-nav__link">
    <span class="md-ellipsis">
      
        GNN Models
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GNN Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gnn" class="md-nav__link">
    <span class="md-ellipsis">
      
        GNN
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gnnsymmetric" class="md-nav__link">
    <span class="md-ellipsis">
      
        GNNSymmetric
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nodevargnn" class="md-nav__link">
    <span class="md-ellipsis">
      
        NodeVarGNN
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hybrid-models" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hybrid Models
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hybrid Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sequentialdenoisingmodel" class="md-nav__link">
    <span class="md-ellipsis">
      
        SequentialDenoisingModel
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spectral-denoisers" class="md-nav__link">
    <span class="md-ellipsis">
      
        Spectral Denoisers
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Spectral Denoisers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#linearpe" class="md-nav__link">
    <span class="md-ellipsis">
      
        LinearPE
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphfilterbank" class="md-nav__link">
    <span class="md-ellipsis">
      
        GraphFilterBank
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#selfattentiondenoiser" class="md-nav__link">
    <span class="md-ellipsis">
      
        SelfAttentionDenoiser
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#digress-models" class="md-nav__link">
    <span class="md-ellipsis">
      
        DiGress Models
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DiGress Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#digress-transformer" class="md-nav__link">
    <span class="md-ellipsis">
      
        DiGress Transformer
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#baseline-models" class="md-nav__link">
    <span class="md-ellipsis">
      
        Baseline Models
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Baseline Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#linear-baseline" class="md-nav__link">
    <span class="md-ellipsis">
      
        Linear Baseline
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlp-baseline" class="md-nav__link">
    <span class="md-ellipsis">
      
        MLP Baseline
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#layers" class="md-nav__link">
    <span class="md-ellipsis">
      
        Layers
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Layers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#eigenembedding" class="md-nav__link">
    <span class="md-ellipsis">
      
        EigenEmbedding
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphconvolutionlayer" class="md-nav__link">
    <span class="md-ellipsis">
      
        GraphConvolutionLayer
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiheadattention" class="md-nav__link">
    <span class="md-ellipsis">
      
        MultiHeadAttention
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#domain-transformations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Domain Transformations
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Domain Transformations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#standard-domain" class="md-nav__link">
    <span class="md-ellipsis">
      
        Standard Domain
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inv-sigmoid-domain" class="md-nav__link">
    <span class="md-ellipsis">
      
        Inv-Sigmoid Domain
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eigenvalue-regularization" class="md-nav__link">
    <span class="md-ellipsis">
      
        Eigenvalue Regularization
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloud/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cloud execution
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../extending/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Extending
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/tmgg/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    tmgg
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Experiments
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Experiments
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/experiments/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/experiments/attention_denoising/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Attention denoising
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/experiments/baselines/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Baselines
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/experiments/digress_denoising/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DiGress denoising
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/experiments/gnn_denoising/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GNN denoising
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/experiments/hybrid_denoising/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hybrid denoising
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/experiments/spectral_denoising/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Spectral denoising
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/experiments/stages/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Stages
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Experiment utils
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Experiment utils
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/experiment_utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/experiment_utils/cloud/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cloud
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/experiment_utils/data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/experiment_utils/tensorboard_export/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    TensorBoard export
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/experiment_utils/wandb_export/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    W&B export
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Models
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Models
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/models/attention/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Attention
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/models/baselines/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Baselines
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/models/digress/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DiGress
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/models/gnn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GNN
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/models/hybrid/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hybrid
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/models/layers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Layers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/models/spectral_denoisers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Spectral denoisers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_6" >
        
          
          <label class="md-nav__link" for="__nav_4_6" id="__nav_4_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Modal
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Modal
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/modal/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/modal/stages/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Stages
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#model-hierarchy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Model Hierarchy
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#attention-models" class="md-nav__link">
    <span class="md-ellipsis">
      
        Attention Models
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attention Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#multilayerattention" class="md-nav__link">
    <span class="md-ellipsis">
      
        MultiLayerAttention
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gnn-models" class="md-nav__link">
    <span class="md-ellipsis">
      
        GNN Models
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GNN Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gnn" class="md-nav__link">
    <span class="md-ellipsis">
      
        GNN
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gnnsymmetric" class="md-nav__link">
    <span class="md-ellipsis">
      
        GNNSymmetric
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nodevargnn" class="md-nav__link">
    <span class="md-ellipsis">
      
        NodeVarGNN
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hybrid-models" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hybrid Models
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hybrid Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sequentialdenoisingmodel" class="md-nav__link">
    <span class="md-ellipsis">
      
        SequentialDenoisingModel
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spectral-denoisers" class="md-nav__link">
    <span class="md-ellipsis">
      
        Spectral Denoisers
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Spectral Denoisers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#linearpe" class="md-nav__link">
    <span class="md-ellipsis">
      
        LinearPE
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphfilterbank" class="md-nav__link">
    <span class="md-ellipsis">
      
        GraphFilterBank
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#selfattentiondenoiser" class="md-nav__link">
    <span class="md-ellipsis">
      
        SelfAttentionDenoiser
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#digress-models" class="md-nav__link">
    <span class="md-ellipsis">
      
        DiGress Models
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DiGress Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#digress-transformer" class="md-nav__link">
    <span class="md-ellipsis">
      
        DiGress Transformer
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#baseline-models" class="md-nav__link">
    <span class="md-ellipsis">
      
        Baseline Models
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Baseline Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#linear-baseline" class="md-nav__link">
    <span class="md-ellipsis">
      
        Linear Baseline
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlp-baseline" class="md-nav__link">
    <span class="md-ellipsis">
      
        MLP Baseline
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#layers" class="md-nav__link">
    <span class="md-ellipsis">
      
        Layers
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Layers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#eigenembedding" class="md-nav__link">
    <span class="md-ellipsis">
      
        EigenEmbedding
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphconvolutionlayer" class="md-nav__link">
    <span class="md-ellipsis">
      
        GraphConvolutionLayer
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiheadattention" class="md-nav__link">
    <span class="md-ellipsis">
      
        MultiHeadAttention
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#domain-transformations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Domain Transformations
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Domain Transformations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#standard-domain" class="md-nav__link">
    <span class="md-ellipsis">
      
        Standard Domain
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inv-sigmoid-domain" class="md-nav__link">
    <span class="md-ellipsis">
      
        Inv-Sigmoid Domain
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eigenvalue-regularization" class="md-nav__link">
    <span class="md-ellipsis">
      
        Eigenvalue Regularization
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  

<h1 id="models">Models<a class="headerlink" href="#models" title="Permanent link">&para;</a></h1>
<p>This document describes the model architectures available in the framework.</p>
<h2 id="model-hierarchy">Model Hierarchy<a class="headerlink" href="#model-hierarchy" title="Permanent link">&para;</a></h2>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>BaseModel (src/tmgg/models/base.py)
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>└── DenoisingModel
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    ├── MultiLayerAttention (attention/attention.py)
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    ├── GNN (gnn/gnn.py)
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    ├── GNNSymmetric (gnn/gnn_sym.py)
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    ├── NodeVarGNN (gnn/nvgnn.py)
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    ├── SequentialDenoisingModel (hybrid/hybrid.py)
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    └── Spectral denoisers (spectral_denoisers/)
</span></code></pre></div>
<p>All models inherit from <code>DenoisingModel</code>, which provides domain transformations and configuration utilities.</p>
<h2 id="attention-models">Attention Models<a class="headerlink" href="#attention-models" title="Permanent link">&para;</a></h2>
<h3 id="multilayerattention">MultiLayerAttention<a class="headerlink" href="#multilayerattention" title="Permanent link">&para;</a></h3>
<p>Multi-layer transformer attention for denoising adjacency matrices. Processes the full adjacency matrix through stacked self-attention layers.</p>
<p><strong>Location:</strong> <code>src/tmgg/models/attention/attention.py</code></p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>d_model</code></td>
<td>int</td>
<td>required</td>
<td>Model dimension (typically num_nodes)</td>
</tr>
<tr>
<td><code>num_heads</code></td>
<td>int</td>
<td>required</td>
<td>Number of attention heads</td>
</tr>
<tr>
<td><code>num_layers</code></td>
<td>int</td>
<td>required</td>
<td>Number of transformer layers</td>
</tr>
<tr>
<td><code>d_k</code></td>
<td>int</td>
<td>None</td>
<td>Key dimension (defaults to d_model // num_heads)</td>
</tr>
<tr>
<td><code>d_v</code></td>
<td>int</td>
<td>None</td>
<td>Value dimension (defaults to d_model // num_heads)</td>
</tr>
<tr>
<td><code>dropout</code></td>
<td>float</td>
<td>0.0</td>
<td>Dropout rate</td>
</tr>
<tr>
<td><code>bias</code></td>
<td>bool</td>
<td>True</td>
<td>Use bias in linear layers</td>
</tr>
<tr>
<td><code>domain</code></td>
<td>str</td>
<td>"standard"</td>
<td>Domain transformation</td>
</tr>
</tbody>
</table>
<p><strong>Config:</strong> <code>exp_configs/models/attention/multi_layer_attention.yaml</code></p>
<p><strong>Usage:</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">tmgg.models.attention</span><span class="w"> </span><span class="kn">import</span> <span class="n">MultiLayerAttention</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="n">model</span> <span class="o">=</span> <span class="n">MultiLayerAttention</span><span class="p">(</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>    <span class="n">d_model</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>    <span class="n">num_heads</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>    <span class="n">num_layers</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="p">)</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">adjacency_matrix</span><span class="p">)</span>  <span class="c1"># (batch, n, n) -&gt; (batch, n, n)</span>
</span></code></pre></div>
<h2 id="gnn-models">GNN Models<a class="headerlink" href="#gnn-models" title="Permanent link">&para;</a></h2>
<p>All GNN models use spectral embeddings via eigendecomposition of the adjacency matrix.</p>
<h3 id="gnn">GNN<a class="headerlink" href="#gnn" title="Permanent link">&para;</a></h3>
<p>Standard graph neural network with polynomial graph convolution filters.</p>
<p><strong>Location:</strong> <code>src/tmgg/models/gnn/gnn.py</code></p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>num_layers</code></td>
<td>int</td>
<td>required</td>
<td>Number of GCN layers</td>
</tr>
<tr>
<td><code>num_terms</code></td>
<td>int</td>
<td>3</td>
<td>Polynomial filter terms</td>
</tr>
<tr>
<td><code>feature_dim_in</code></td>
<td>int</td>
<td>10</td>
<td>Input feature dimension</td>
</tr>
<tr>
<td><code>feature_dim_out</code></td>
<td>int</td>
<td>10</td>
<td>Output feature dimension</td>
</tr>
<tr>
<td><code>eigenvalue_reg</code></td>
<td>float</td>
<td>0.0</td>
<td>Eigenvalue regularization</td>
</tr>
<tr>
<td><code>domain</code></td>
<td>str</td>
<td>"standard"</td>
<td>Domain transformation</td>
</tr>
</tbody>
</table>
<p><strong>Config:</strong> <code>exp_configs/models/gnn/standard_gnn.yaml</code></p>
<p><strong>Returns:</strong> Tuple of (X, Y) embeddings for reconstruction via X @ Y.T</p>
<h3 id="gnnsymmetric">GNNSymmetric<a class="headerlink" href="#gnnsymmetric" title="Permanent link">&para;</a></h3>
<p>Symmetric GNN with shared X and Y embeddings. Uses a single embedding pathway, making the reconstruction inherently symmetric.</p>
<p><strong>Location:</strong> <code>src/tmgg/models/gnn/gnn_sym.py</code></p>
<p><strong>Config:</strong> <code>exp_configs/models/gnn/symmetric_gnn.yaml</code></p>
<p><strong>Returns:</strong> Tuple of (reconstructed_adjacency, X_embeddings)</p>
<h3 id="nodevargnn">NodeVarGNN<a class="headerlink" href="#nodevargnn" title="Permanent link">&para;</a></h3>
<p>Node-variant GNN with per-node filter coefficients. Allows heterogeneous processing across nodes.</p>
<p><strong>Location:</strong> <code>src/tmgg/models/gnn/nvgnn.py</code></p>
<p><strong>Config:</strong> <code>exp_configs/models/gnn/nodevar_gnn.yaml</code></p>
<h2 id="hybrid-models">Hybrid Models<a class="headerlink" href="#hybrid-models" title="Permanent link">&para;</a></h2>
<h3 id="sequentialdenoisingmodel">SequentialDenoisingModel<a class="headerlink" href="#sequentialdenoisingmodel" title="Permanent link">&para;</a></h3>
<p>Combines a GNN embedding model with a transformer denoising model. The GNN extracts node embeddings, which are then processed by attention layers.</p>
<p><strong>Location:</strong> <code>src/tmgg/models/hybrid/hybrid.py</code></p>
<p><strong>Usage:</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">tmgg.models.hybrid</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_sequential_model</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="n">model</span> <span class="o">=</span> <span class="n">create_sequential_model</span><span class="p">(</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>    <span class="n">gnn_config</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;num_layers&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;feature_dim_out&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>    <span class="n">transformer_config</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;num_heads&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;num_layers&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="p">)</span>
</span></code></pre></div>
<p><strong>Config:</strong> <code>exp_configs/models/hybrid/hybrid_with_transformer.yaml</code></p>
<h2 id="spectral-denoisers">Spectral Denoisers<a class="headerlink" href="#spectral-denoisers" title="Permanent link">&para;</a></h2>
<p>Models operating in the spectral domain, using the eigendecomposition of the noisy adjacency matrix. All output raw logits; use <code>model.predict(logits)</code> for [0,1] probabilities.</p>
<p><strong>Location:</strong> <code>src/tmgg/models/spectral_denoisers/</code></p>
<h3 id="linearpe">LinearPE<a class="headerlink" href="#linearpe" title="Permanent link">&para;</a></h3>
<p>Linear transformation in eigenspace with optional bias correction.</p>
<p><strong>Formula:</strong>
<div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>Â = V W V^T + 1 b^T + b 1^T
</span></code></pre></div></p>
<p>where V ∈ R^{n×k} are top-k eigenvectors, W ∈ R^{k×k} is learnable, and b ∈ R^{max_n} is a bias vector capturing node-specific degree corrections.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>k</code></td>
<td>int</td>
<td>required</td>
<td>Number of eigenvectors</td>
</tr>
<tr>
<td><code>max_nodes</code></td>
<td>int</td>
<td>200</td>
<td>Maximum graph size (for bias)</td>
</tr>
<tr>
<td><code>use_bias</code></td>
<td>bool</td>
<td>True</td>
<td>Enable node-specific bias term</td>
</tr>
</tbody>
</table>
<p><strong>Config:</strong> <code>exp_configs/models/spectral/linear_pe.yaml</code></p>
<h3 id="graphfilterbank">GraphFilterBank<a class="headerlink" href="#graphfilterbank" title="Permanent link">&para;</a></h3>
<p>Spectral polynomial filter with learnable coefficient matrices.</p>
<p><strong>Formula:</strong>
<div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>W = Σ_{ℓ=0}^{K-1} Λ^ℓ ⊙ H^{(ℓ)}
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>Â = V W V^T
</span></code></pre></div></p>
<p>where H^{(ℓ)} ∈ R^{k×k} are learnable coefficient matrices. The polynomial filter allows learning frequency-dependent transformations: different eigenvalue magnitudes can be amplified or attenuated differently.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>k</code></td>
<td>int</td>
<td>required</td>
<td>Number of eigenvectors</td>
</tr>
<tr>
<td><code>polynomial_degree</code></td>
<td>int</td>
<td>5</td>
<td>Polynomial degree K</td>
</tr>
</tbody>
</table>
<p><strong>Config:</strong> <code>exp_configs/models/spectral/filter_bank.yaml</code></p>
<h3 id="selfattentiondenoiser">SelfAttentionDenoiser<a class="headerlink" href="#selfattentiondenoiser" title="Permanent link">&para;</a></h3>
<p>Scaled dot-product attention on eigenvector embeddings.</p>
<p><strong>Formula:</strong>
<div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>Q = V W_Q,  K = V W_K
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>Â = Q K^T / √d_k
</span></code></pre></div></p>
<p>where W_Q, W_K ∈ R^{k×d_k} are learnable projections. The 1/√d_k scaling stabilizes gradients following transformer practice.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>k</code></td>
<td>int</td>
<td>required</td>
<td>Number of eigenvectors (input dim)</td>
</tr>
<tr>
<td><code>d_k</code></td>
<td>int</td>
<td>64</td>
<td>Key/query dimension</td>
</tr>
</tbody>
</table>
<p><strong>Config:</strong> <code>exp_configs/models/spectral/self_attention.yaml</code></p>
<h2 id="digress-models">DiGress Models<a class="headerlink" href="#digress-models" title="Permanent link">&para;</a></h2>
<p>Diffusion-based transformer for graph denoising. Used as baseline for comparing spectral architectures.</p>
<p><strong>Location:</strong> <code>src/tmgg/models/digress/</code></p>
<h3 id="digress-transformer">DiGress Transformer<a class="headerlink" href="#digress-transformer" title="Permanent link">&para;</a></h3>
<p>Score-based model operating on graph structure. Two variants are used in experiments:</p>
<p><strong>Official settings</strong> (<code>digress_sbm_small.yaml</code>):
- LR=0.0002, AdamW + amsgrad, weight_decay=1e-12
- No LR scheduling</p>
<p><strong>High LR variant</strong> (<code>digress_sbm_small_highlr.yaml</code>):
- LR=1e-2 (matching spectral models)
- For fair comparison with spectral architectures</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>n_layers</code></td>
<td>int</td>
<td>4</td>
<td>Number of transformer layers</td>
</tr>
<tr>
<td><code>node_feature_dim</code></td>
<td>int</td>
<td>50</td>
<td>Node feature dimension</td>
</tr>
<tr>
<td><code>use_eigenvectors</code></td>
<td>bool</td>
<td>True</td>
<td>Use eigenvector features</td>
</tr>
<tr>
<td><code>hidden_dims.dx</code></td>
<td>int</td>
<td>128</td>
<td>Node hidden dimension</td>
</tr>
<tr>
<td><code>hidden_dims.de</code></td>
<td>int</td>
<td>32</td>
<td>Edge hidden dimension</td>
</tr>
<tr>
<td><code>hidden_dims.n_head</code></td>
<td>int</td>
<td>4</td>
<td>Number of attention heads</td>
</tr>
</tbody>
</table>
<p><strong>Config:</strong> <code>exp_configs/models/digress/digress_sbm_small.yaml</code></p>
<h2 id="baseline-models">Baseline Models<a class="headerlink" href="#baseline-models" title="Permanent link">&para;</a></h2>
<p>Simple baselines for comparison.</p>
<p><strong>Location:</strong> <code>src/tmgg/experiments/baselines/</code></p>
<h3 id="linear-baseline">Linear Baseline<a class="headerlink" href="#linear-baseline" title="Permanent link">&para;</a></h3>
<p>Linear transformation initialized at identity.</p>
<p><strong>Formula:</strong>
<div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>A_pred = W @ A @ W^T + b
</span></code></pre></div></p>
<p><strong>Config:</strong> <code>exp_configs/models/baselines/linear.yaml</code></p>
<h3 id="mlp-baseline">MLP Baseline<a class="headerlink" href="#mlp-baseline" title="Permanent link">&para;</a></h3>
<p>Multi-layer perceptron applied to flattened adjacency.</p>
<p><strong>Config:</strong> <code>exp_configs/models/baselines/mlp.yaml</code></p>
<h2 id="layers">Layers<a class="headerlink" href="#layers" title="Permanent link">&para;</a></h2>
<p>Shared layers used by the models:</p>
<h3 id="eigenembedding">EigenEmbedding<a class="headerlink" href="#eigenembedding" title="Permanent link">&para;</a></h3>
<p>Computes eigenvector embeddings from adjacency matrices.</p>
<p><strong>Location:</strong> <code>src/tmgg/models/layers/eigen_embedding.py</code></p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>eigenvalue_reg</code></td>
<td>float</td>
<td>0.0</td>
<td>Diagonal regularization for gradient stability</td>
</tr>
</tbody>
</table>
<p>Eigendecomposition gradients can be unstable when eigenvalues are close together. Setting <code>eigenvalue_reg</code> to a small value (e.g., 1e-3) adds a diagonal perturbation that spreads eigenvalues apart.</p>
<h3 id="graphconvolutionlayer">GraphConvolutionLayer<a class="headerlink" href="#graphconvolutionlayer" title="Permanent link">&para;</a></h3>
<p>Polynomial graph convolution layer.</p>
<p><strong>Location:</strong> <code>src/tmgg/models/layers/gcn.py</code></p>
<h3 id="multiheadattention">MultiHeadAttention<a class="headerlink" href="#multiheadattention" title="Permanent link">&para;</a></h3>
<p>Standard multi-head attention layer.</p>
<p><strong>Location:</strong> <code>src/tmgg/models/layers/mha_layer.py</code></p>
<h2 id="domain-transformations">Domain Transformations<a class="headerlink" href="#domain-transformations" title="Permanent link">&para;</a></h2>
<p>Models support two domain transformations, configured via the <code>domain</code> parameter:</p>
<h3 id="standard-domain">Standard Domain<a class="headerlink" href="#standard-domain" title="Permanent link">&para;</a></h3>
<ul>
<li>Input: Adjacency matrix used directly</li>
<li>Output: Sigmoid applied to produce probabilities in [0, 1]</li>
</ul>
<h3 id="inv-sigmoid-domain">Inv-Sigmoid Domain<a class="headerlink" href="#inv-sigmoid-domain" title="Permanent link">&para;</a></h3>
<ul>
<li>Input: Logit transform applied (numerically stabilized)</li>
<li>Output: In training mode, raw logits are returned for BCEWithLogitsLoss; in eval mode, sigmoid is applied</li>
</ul>
<p>The inv-sigmoid domain can improve numerical stability for sparse graphs.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="c1"># Using inv-sigmoid domain</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="n">model</span> <span class="o">=</span> <span class="n">GNN</span><span class="p">(</span><span class="n">num_layers</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s2">&quot;inv-sigmoid&quot;</span><span class="p">)</span>
</span></code></pre></div>
<h2 id="eigenvalue-regularization">Eigenvalue Regularization<a class="headerlink" href="#eigenvalue-regularization" title="Permanent link">&para;</a></h2>
<p>GNN models can experience gradient instability due to eigendecomposition. When eigenvalues are close together, gradients involve terms like 1/(λ_i - λ_j) that can explode.</p>
<p>To mitigate this, set <code>eigenvalue_reg</code> to a small positive value:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">model</span> <span class="o">=</span> <span class="n">GNN</span><span class="p">(</span><span class="n">num_layers</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">eigenvalue_reg</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
</span></code></pre></div>
<p>This adds <code>eigenvalue_reg * I</code> to the adjacency matrix before eigendecomposition, spreading eigenvalues apart. Use values between 1e-4 and 1e-2 if you observe NaN gradients or unstable training.</p>














                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://zensical.org/" target="_blank" rel="noopener">
      Zensical
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      
      <script id="__config" type="application/json">{"annotate":null,"base":"..","features":[],"search":"../assets/javascripts/workers/search.5df7522c.min.js","tags":null,"translations":{"clipboard.copied":"Copied to clipboard","clipboard.copy":"Copy to clipboard","search.result.more.one":"1 more on this page","search.result.more.other":"# more on this page","search.result.none":"No matching documents","search.result.one":"1 matching document","search.result.other":"# matching documents","search.result.placeholder":"Type to start searching","search.result.term.missing":"Missing","select.version":"Select version"},"version":null}</script>
    
    
      <script src="../assets/javascripts/bundle.21aa498e.min.js"></script>
      
    
  </body>
</html>